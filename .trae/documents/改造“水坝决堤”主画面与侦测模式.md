## 总体目标

* 用概念图与文字说明组成的引导区替换主画面上方简陋展示；仅保留大坝四区（A/B/C/D）主场景。

* 优化裂纹表现、热成像效果、档案文案与水位标尺；完善交互（悬停提示、重置清空推理记录、声波图标）。

## UI改造

1. 在主场景上方新增两栏区域（左图右文）：

   * 左：缩略图，使用相对路径 `水坝决堤概念图.png`（与 HTML 同目录）。

   * 右：文字区，显示“游戏背景”“任务目标”“游戏提示”，从现有提示文案抽取并格式化。
2. 主场景仅保留四区大坝：

   * 移除顶部“水域”和底部“农田”绘制；在画布上居中绘制四分区并标注“大坝外立面”。

   * 参考画布尺寸 `800x520（但需要能自适应屏幕）`，四区按 2x2 网格均分，并保留区字母标识。

## 裂纹重绘与交互

1. 裂纹形态：

   * 将当前的短直线替换为“主干+支线”的不规则折线：主干为 3–6 段折线，夹杂轻微随机扰动；每条主干在 1–2 处生成短支线。

   * 提供多样长度（20–80px）与角度；视觉更像真实裂纹。
2. 交互：

   * 鼠标悬停到裂纹上，显示气泡提示“⛏ 大坝上的裂纹”（距指针 12px 的浮层）；离开时隐藏。

   * 技术实现：为每条裂纹存储点序列，使用“点到线段最短距离”阈值（≤6px）做命中检测；在 `mousemove` 事件中执行。
3. 效果取消：去除点击失败时对画布添加的 `shake` 震动类（代码位于 `showMinorLeak`），保留局部波纹/小水滴或弱化为轻微透明波纹。
4. 数量调整：

   * D 区裂纹增加到比其他区多（例如 A/B/C: 6–8 条；D: 10–12 条）。

## 热成像模式

1. 视觉原则：仅呈现“模糊的淡蓝色光斑”，不使用圆形放射状图案。
2. 分布规则：

   * C 区 3 个淡蓝光斑：其中 1 个略深、面积中等；另外 2 个更浅更小；均为椭圆/不规则涂抹（非同心圆）。

   * D 区 1 个淡蓝光斑：面积较大但颜色更浅。
3. 图层与合成：

   * 先绘制裂纹，再以 `globalAlpha≈0.35–0.5` 的蓝色半透明多段笔触/大半径高斯模糊替代实现（使用多次 `fill()` 与 `shadowBlur` 或离屏 `Canvas` 生成柔和边缘）。

   * 每个光斑下方对应若干裂纹，保证逻辑一致性。

## 档案文案调整

1. 在档案弹窗中移除特别提醒的样式元素：红色边框、感叹号图标、黄色高亮、加粗黑体等。
2. 将表述由“主排水口左下方约5米处”改为“水位标尺约5米处”。
3. 其余内容保持为 3–4 条普通列表项，整体采用中性灰样式。

## 水位标尺

1. B、D 右沿绘制垂直水位标尺：

   * D 区右下角标注 `0m`；B 区右上角标注 `30m`；每 5m 画短刻度并标注（如 `5m/10m/.../25m`）。

   * 标尺位于四区分割线右侧，与画布坐标统一，使用小字号浅灰文字（避免破坏主画面）。

## 图标与缩略图

1. 左侧工具栏将“音符”改为“声波”图标：使用内联 SVG 三条波形线段（如 `path` 曲线），保留按钮交互逻辑不变。
2. 主界面左上缩略图：

   * 以 `<img id="miniPreview" src="水坝决堤概念图.png">` 放入预览卡槽；尺寸自适应并保留圆角阴影。

## 推理记录

1. 右侧推理记录容器在 `restartGame()`、或点击“重置任务”时执行 `innerHTML=''` 清空。
2. 新增一个 `appendLog(text)` 工具方法，统一写入记录，便于后续扩展。

## 代码落点（当前文件参考）

* 绘制主场景与四区：`drawScene()`（约 `3.水坝决堤.html:344` 起）

  * 移除水域/农田绘制；改为四区矩形与标签；添加标尺绘制逻辑。

* 裂纹数据结构与绘制：`generateFakeCracks()` 与 `drawCrack()`（约 `:335` 与 `:449`）

  * 将裂纹改为折线+支线；在生成时按区分配、增强 D 区数量。

* 悬停提示：新增 `mousemove` 监听与命中检测，挂在 `setupEventListeners()`（约 `:512`）。

* 热成像图层：`renderThermal()`（约 `:431`）

  * 替换为蓝色模糊涂抹的非放射状光斑；按区坐标绘制。

* 档案弹窗内容：`#archiveModal` 模板（约 `:941`）与文案更新逻辑。

* 取消震动：`showMinorLeak()`（约 `:585`）移除 `shake` 类相关代码。

* 缩略图：新增主界面上方网格区 HTML 与样式；在初始化时填充图片。

* 声波图标：替换按钮的 SVG 图标资源（无外部库依赖）。

* 清空推理记录：`restartGame()`（约 `:934`）增加一行 `document.getElementById('reasonLog').innerHTML=''`。

## 验证与兼容

* 桌面与移动端：悬停提示在移动端改为“长按 400ms 显示”；点击不触发提示。

* 性能：裂纹为轻量折线，热成像用有限个形状与一次性离屏缓存，保持 60fps。

* 资源路径：概念图以相对路径引用；如需子目录，请将图片置于同目录或更新 `src`。

## 澄清点（可选）

* 悬停提示触发在移动端是否需要常驻提示条？使用方案：长按弹出 1.5s 后自动隐藏。

* 推理记录容器的具体 DOM `id` 名称（如已有，则沿用；若未有，我将新增 `reasonLog`）。

